<!DOCTYPE html>
<html dir="ltr" lang="en-US">

<head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1" name="viewport">


    <!-- ===============================================-->
    <!--    Document Title-->
    <!-- ===============================================-->
    <title>Indolens {{request.session.store_name}} - Dashboard</title>


    <!-- ===============================================-->
    <!--    Favicons-->
    <!-- ===============================================-->
    {% load static %}

    <link href="{% static 'img/favicons/apple-touch-icon.png' %}" rel="apple-touch-icon" sizes="180x180">
    <link href="{% static 'img/favicons/favicon-32x32.png' %}" rel="icon" sizes="32x32" type="image/png">
    <link href="{% static 'img/favicons/favicon-16x16.png' %}" rel="icon" sizes="16x16" type="image/png">
    <link href="{% static 'img/favicons/favicon.ico' %}" rel="shortcut icon" type="image/x-icon">
    <link href="{% static 'img/favicons/manifest.json' %}" rel="manifest">
    <meta content="{% static 'img/favicons/mstile-150x150.png' %}" name="msapplication-TileImage">
    <meta content="#ffffff" name="theme-color">
    <script src="{% static 'vendors/imagesloaded/imagesloaded.pkgd.min.js' %}"></script>
    <script src="{% static 'vendors/simplebar/simplebar.min.js' %}"></script>
    <script src="{% static 'js/config.js' %}"></script>

    <!-- ===============================================-->
    <!--    Stylesheets-->
    <!-- ===============================================-->
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700;800;900&amp;display=swap"
          rel="stylesheet">
    <link href="{% static 'vendors/simplebar/simplebar.min.css' %}" rel="stylesheet">
    <link href="https://unicons.iconscout.com/release/v4.0.0/css/line.css" rel="stylesheet">
    <link href="{% static 'css/theme-rtl.min.css' %}" id="style-rtl" rel="stylesheet" type="text/css">
    <link href="{% static 'css/theme.min.css' %}" id="style-default" rel="stylesheet" type="text/css">
    <link href="{% static 'css/user-rtl.min.css' %}" id="user-style-rtl" rel="stylesheet" type="text/css">
    <link href="{% static 'css/user.min.css' %}" id="user-style-default" rel="stylesheet" type="text/css">
    <link href="{% static 'vendors/flatpickr/flatpickr.min.css' %}" rel="stylesheet"/>

    <script>
      var isRTL = JSON.parse(localStorage.getItem('isRTL'));
      if (isRTL) {
        var linkDefault = document.getElementById('style-default');
        var userLinkDefault = document.getElementById('user-style-default');
        linkDefault.setAttribute('disabled', true);
        userLinkDefault.setAttribute('disabled', true);
        document.querySelector('html').setAttribute('dir', 'rtl');
      } else {
        var linkRTL = document.getElementById('style-rtl');
        var userLinkRTL = document.getElementById('user-style-rtl');
        linkRTL.setAttribute('disabled', true);
        userLinkRTL.setAttribute('disabled', true);
      }










    </script>
</head>


<body>

<!-- ===============================================-->
<!--    Main Content-->
<!-- ===============================================-->
<main class="main" id="top">
    <div class="container-fluid px-0">
        {% include 'nav_bar_store.html' %}

        <div class="content">
            <div class="pb-5">
                <div class="row g-4">
                    <div class="col-12 col-xxl-6">
                        <div class="mb-4">
                            <h2 class="mb-2">Hi {{request.session.name}}</h2>
                            <h5 class="text-700 fw-semi-bold">
                                {% if request.session.role == 1 %}
                                Store Manager
                                {% elif request.session.role == 2 %}
                                Store Optometry
                                {% elif request.session.role == 3 %}
                                Sales Executive
                                {% else %}
                                Unknown Role
                                {% endif %}
                                : {{request.session.store_name}}
                            </h5>
                        </div>

                        <div class="row align-items-center g-4 mt-2">

                            <div class="col-12 col-md-auto">
                                <div class="d-flex align-items-center"><img
                                        alt="" height="46" src="{% static 'img/icons/illustrations/4l.png' %}"
                                        width="46"/>

                                    <div class="ms-3">
                                        <h4 class="mb-0">â‚¹ {{own_store_sale}} Sales</h4>
                                        <p class="text-800 fs--1 mb-0">From Your store</p>
                                    </div>
                                </div>
                            </div>

                            <div class="col-12 col-md-auto">
                                <div class="d-flex align-items-center"><img
                                        alt="" height="46" src="{% static 'img/icons/illustrations/4l.png' %}"
                                        width="46"/>

                                    <div class="ms-3">
                                        <h4 class="mb-0"><a href="{% url 'new_store_orders' %}">
                                            {{own_store_new_order}} new orders</a></h4>
                                        <p class="text-800 fs--1 mb-0">New orders</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-md-auto">
                                <div class="d-flex align-items-center"><img
                                        alt=""
                                        height="46" src="{% static 'img/icons/illustrations/3l.png' %}" width="46"/>

                                    <div class="ms-3">
                                        <h4 class="mb-0"><a href="{% url 'completed_store_orders' %}">
                                            {{own_store_delivered_orders}} Delivered</a>
                                        </h4>
                                        <p class="text-800 fs--1 mb-0">Orders delivered</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-md-auto">
                                <div class="d-flex align-items-center"><img
                                        alt=""
                                        height="46" src="{% static 'img/icons/illustrations/2l.png' %}" width="46"/>
                                    <div class="ms-3">
                                        <h4 class="mb-0"><a href="{% url 'manage_store_out_of_stock' %}">
                                            {{out_of_stock}} products</a>
                                        </h4>
                                        <p class="text-800 fs--1 mb-0">Out of stock</p>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <hr class="bg-200 mb-6 mt-4"/>
                        <div class="row flex-between-center mb-4 g-3">
                            <div class="col-auto">
                                <h3>Total sales</h3>
                                <p class="text-700 lh-sm mb-0">Payment received across all channels</p>
                            </div>
                            <div class="col-8 col-sm-4">
                                <input class="form-control mt-2 datetimepicker flatpickr-input" id="timepicker2"
                                       type="text" placeholder="dd/mm/yyyy to dd/mm/yyyy"
                                       onchange="callApiForSalesGraph(this.value);"
                                       data-options="{&quot;mode&quot;:&quot;range&quot;,&quot;dateFormat&quot;:&quot;d/m/y&quot;,&quot;disableMobile&quot;:true}"
                                       readonly="readonly">
                            </div>
                        </div>
                        <div class="echart-total-sales-chart" data-echart-responsive="data-echart-responsive"
                             style="min-height:320px;width:100%"></div>
                        <!--  OWN STORE FRANCHISE ANALYTICS STARTS HERE-->

<!--                        <div class="row gx-6">-->
<!--                            <div class="col-12 col-xl-6">-->
<!--                                <div class="mb-5 mt-7">-->
<!--                                    <h3>Your store - Analytics This Week</h3>-->
<!--                                    <p class="text-700">Glimpses of revenue and spend for your store this week</p>-->
<!--                                </div>-->
<!--                                <div class="table-responsive scrollbar">-->
<!--                                    <table class="table fs&#45;&#45;2 mb-0">-->
<!--                                        <thead>-->
<!--                                        <tr>-->
<!--                                            <th class="border-top border-200 ps-0 align-middle" scope="col"-->
<!--                                                style="width:32%">-->
<!--                                                DAY-->
<!--                                            </th>-->
<!--                                            <th class="border-top border-200 align-middle" scope="col"-->
<!--                                                style="width:17%">SALES-->
<!--                                            </th>-->
<!--                                            <th class="border-top border-200 text-end align-middle" scope="col"-->
<!--                                                style="width:16%">-->
<!--                                                EXPENSES-->
<!--                                            </th>-->
<!--                                            <th class="border-top border-200 text-end align-middle" scope="col"-->
<!--                                                style="width:20%">-->
<!--                                                NET BALANCE-->
<!--                                            </th>-->

<!--                                        </tr>-->
<!--                                        </thead>-->
<!--                                        <tbody class="list">-->
<!--                                        <tr>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">Monday</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹22,367</h4>-->

<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹2,367</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹15,758</h4>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        <tr>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">Tuesday</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹22,367</h4>-->

<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹2,367</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹15,758</h4>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        <tr>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">Wednesday</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹22,367</h4>-->

<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹2,367</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹15,758</h4>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        <tr>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">Thursday</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹22,367</h4>-->

<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹2,367</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹15,758</h4>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        <tr>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">Friday</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹22,367</h4>-->

<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹2,367</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹15,758</h4>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        <tr>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">Saturday</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹22,367</h4>-->

<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹2,367</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹15,758</h4>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        </tbody>-->
<!--                                    </table>-->
<!--                                </div>-->
<!--                            </div>-->


<!--                            <div class="col-12 col-xl-6">-->
<!--                                <div class="mb-5 mt-7">-->
<!--                                    <h3>Your store - Analytics This Month</h3>-->
<!--                                    <p class="text-700">Glimpses of revenue and spend for your store this month</p>-->
<!--                                </div>-->
<!--                                <div class="table-responsive scrollbar">-->
<!--                                    <table class="table fs&#45;&#45;2 mb-0">-->
<!--                                        <thead>-->
<!--                                        <tr>-->
<!--                                            <th class="border-top border-200 ps-0 align-middle" scope="col"-->
<!--                                                style="width:32%">-->
<!--                                                WEEK-->
<!--                                            </th>-->
<!--                                            <th class="border-top border-200 align-middle" scope="col"-->
<!--                                                style="width:17%">SALES-->
<!--                                            </th>-->
<!--                                            <th class="border-top border-200 text-end align-middle" scope="col"-->
<!--                                                style="width:16%">-->
<!--                                                EXPENSES-->
<!--                                            </th>-->
<!--                                            <th class="border-top border-200 text-end align-middle" scope="col"-->
<!--                                                style="width:20%">-->
<!--                                                NET BALANCE-->
<!--                                            </th>-->

<!--                                        </tr>-->
<!--                                        </thead>-->
<!--                                        <tbody class="list">-->
<!--                                        <tr>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal"> WEEK 1</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹377,620</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹2,367</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹15,758</h4>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        <tr>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal"> WEEK 2</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹377,620</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹2,367</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹15,758</h4>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        <tr>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal"> WEEK 3</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹377,620</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹2,367</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹15,758</h4>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        <tr>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal"> WEEK 4</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹377,620</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹2,367</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹15,758</h4>-->
<!--                                            </td>-->
<!--                                        </tr>-->
<!--                                        <tr>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal"> WEEK 5</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹377,620</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹2,367</h4>-->
<!--                                            </td>-->
<!--                                            <td class="align-middle text-end py-4">-->
<!--                                                <h4 class="mb-0 fw-normal">â‚¹15,758</h4>-->
<!--                                            </td>-->
<!--                                        </tr>-->

<!--                                        </tbody>-->
<!--                                    </table>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->

                        <!-- OWN STORE FRANCHISE ANALYTICS ENDS HERE-->
                    <div class="mt-3 mx-n4 px-4 mx-lg-n6 px-lg-6 bg-white pt-6 pb-9 border-top border-300">
                            <div class="row g-6">
                                <div class="col-12 col-xl-6">
                                    <div class="me-xl-4">
                                        <div>
                                            <h3>No. Of Customers</h3>
                                            <div class="col-12 col-sm-auto mt-3">
                                                <div class="btn-group" data-gantt-scale="data-gantt-scale"
                                                     role="group">
                                                    <input checked="" class="btn-check" id="customersWeekView"
                                                           name="customersView" type="radio" value="7"/>
                                                    <label class="btn btn-phoenix-secondary hover-bg-100 fs--2 py-1 mb-0"
                                                           for="customersWeekView">Last 7 days</label>
                                                    <input class="btn-check" id="customersMonthView"
                                                           name="customersView"
                                                           type="radio" value="30"/>
                                                    <label class="btn btn-phoenix-secondary hover-bg-100 fs--2 py-1 mb-0"
                                                           for="customersMonthView">Last 30 days</label>
                                                    <input class="btn-check" id="customersYearsView"
                                                           name="customersView"
                                                           type="radio" value="60"/>
                                                    <label class="btn btn-phoenix-secondary hover-bg-100 fs--2 py-1 mb-0"
                                                           for="customersYearsView">Last 60 days</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="echart-projection-actual" style="height:300px; width:100%"
                                             data-echart-responsive="data-echart-responsive"></div>
                                    </div>
                                </div>
                                <div class="col-12 col-xl-6">
                                    <div>
                                        <h3>No. Of Orders</h3>
                                        <div class="col-12 col-sm-auto mt-3">
                                            <div class="btn-group" data-gantt-scale="data-gantt-scale"
                                                 role="group">
                                                <input checked="" class="btn-check" id="ordersWeekView"
                                                       name="ordersView" type="radio" value="7"/>
                                                <label class="btn btn-phoenix-secondary hover-bg-100 fs--2 py-1 mb-0"
                                                       for="ordersWeekView">Last 7 days</label>
                                                <input class="btn-check" id="ordersMonthView" name="ordersView"
                                                       type="radio" value="30"/>
                                                <label class="btn btn-phoenix-secondary hover-bg-100 fs--2 py-1 mb-0"
                                                       for="ordersMonthView">Last 30 days</label>
                                                <input class="btn-check" id="ordersYearsView" name="ordersView"
                                                       type="radio" value="60"/>
                                                <label class="btn btn-phoenix-secondary hover-bg-100 fs--2 py-1 mb-0"
                                                       for="ordersYearsView">Last 60 days</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="echart-returning-customer" style="height:300px;"
                                         data-echart-responsive="data-echart-responsive"></div>
                                </div>
                            </div>
                        </div>

                    </div>
<!--                    <div class="col-12 col-xxl-6">-->
<!--                        <div class="row g-3">-->
<!--                            <div class="col-12 col-md-6">-->
<!--                                <div class="card h-100">-->
<!--                                    <div class="card-body">-->
<!--                                        <div class="d-flex justify-content-between">-->
<!--                                            <div>-->
<!--                                                <h5 class="mb-1">Total orders<span-->
<!--                                                        class="badge badge-phoenix badge-phoenix-warning rounded-pill fs&#45;&#45;1 ms-2"><span-->
<!--                                                        class="badge-label">-6.8%</span></span></h5>-->
<!--                                                <div class="col-12 col-sm-auto">-->
<!--                                                    <div class="btn-group" data-gantt-scale="data-gantt-scale"-->
<!--                                                         role="group">-->
<!--                                                        <input checked="" class="btn-check" id="weekView3"-->
<!--                                                               name="scaleView" type="radio" value="week"/>-->
<!--                                                        <label class="btn btn-phoenix-secondary hover-bg-100 fs&#45;&#45;2 py-1 mb-0"-->
<!--                                                               for="weekView3">Week</label>-->
<!--                                                        <input class="btn-check" id="monthView3" name="scaleView"-->
<!--                                                               type="radio" value="month"/>-->
<!--                                                        <label class="btn btn-phoenix-secondary hover-bg-100 fs&#45;&#45;2 py-1 mb-0"-->
<!--                                                               for="monthView3">Month</label>-->
<!--                                                        <input class="btn-check" id="yearView3" name="scaleView"-->
<!--                                                               type="radio" value="year"/>-->
<!--                                                        <label class="btn btn-phoenix-secondary hover-bg-100 fs&#45;&#45;2 py-1 mb-0"-->
<!--                                                               for="yearView3">Year</label>-->
<!--                                                    </div>-->
<!--                                                </div>-->
<!--                                            </div>-->
<!--                                            <h4>16,247</h4>-->
<!--                                        </div>-->
<!--                                        <div class="d-flex justify-content-center px-4 py-6">-->
<!--                                            <div class="echart-total-orders" style="height:180px;width:100%"></div>-->
<!--                                        </div>-->
<!--                                        <div class="mt-2">-->
<!--                                            <div class="d-flex align-items-center mb-2">-->
<!--                                                <div class="bullet-item bg-primary me-2"></div>-->
<!--                                                <h6 class="text-900 fw-semi-bold flex-1 mb-0">Completed</h6>-->
<!--                                                <h6 class="text-900 fw-semi-bold mb-0">52%</h6>-->
<!--                                            </div>-->
<!--                                            <div class="d-flex align-items-center">-->
<!--                                                <div class="bullet-item bg-primary-100 me-2"></div>-->
<!--                                                <h6 class="text-900 fw-semi-bold flex-1 mb-0">Pending payment</h6>-->
<!--                                                <h6 class="text-900 fw-semi-bold mb-0">48%</h6>-->
<!--                                            </div>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                            <div class="col-12 col-md-6">-->
<!--                                <div class="card h-100">-->
<!--                                    <div class="card-body">-->
<!--                                        <div class="d-flex justify-content-between">-->
<!--                                            <div>-->
<!--                                                <h5 class="mb-1">New customers<span-->
<!--                                                        class="badge badge-phoenix badge-phoenix-warning rounded-pill fs&#45;&#45;1 ms-2"> <span-->
<!--                                                        class="badge-label">+26.5%</span></span></h5>-->
<!--                                                <div class="col-12 col-sm-auto">-->
<!--                                                    <div class="btn-group" data-gantt-scale="data-gantt-scale"-->
<!--                                                         role="group">-->
<!--                                                        <input checked="" class="btn-check" id="weekView4"-->
<!--                                                               name="scaleView" type="radio" value="week"/>-->
<!--                                                        <label class="btn btn-phoenix-secondary hover-bg-100 fs&#45;&#45;2 py-1 mb-0"-->
<!--                                                               for="weekView4">Week</label>-->
<!--                                                        <input class="btn-check" id="monthView4" name="scaleView"-->
<!--                                                               type="radio" value="month"/>-->
<!--                                                        <label class="btn btn-phoenix-secondary hover-bg-100 fs&#45;&#45;2 py-1 mb-0"-->
<!--                                                               for="monthView4">Month</label>-->
<!--                                                        <input class="btn-check" id="yearView4" name="scaleView"-->
<!--                                                               type="radio" value="year"/>-->
<!--                                                        <label class="btn btn-phoenix-secondary hover-bg-100 fs&#45;&#45;2 py-1 mb-0"-->
<!--                                                               for="yearView4">Year</label>-->
<!--                                                    </div>-->
<!--                                                </div>-->
<!--                                            </div>-->
<!--                                            <h4>356</h4>-->
<!--                                        </div>-->
<!--                                        <div class="pb-0 pt-4">-->
<!--                                            <div class="echarts-new-customers" data-echart-responsive="true"-->
<!--                                                 style="height:180px;width:100%;"></div>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
                </div>
            </div>
            <div class="mx-n4 px-4 mx-lg-n6 px-lg-6 bg-white pt-7 border-y border-300">
                <div data-list='{"valueNames":["SlNo","orderId","total","customer","paymentStatus","orderStatus","createdBy","createdOn","updatedBy","updatedOn"],"page":5}'>
                    <div class="row align-items-end justify-content-between pb-5 g-3">
                        <div class="col-auto">
                            <h3>Latest Sales</h3>
                            <p class="text-700 lh-sm mb-0">Latest sales in the Stores</p>
                        </div>
                        <div class="col-12 col-md-auto">
                            <div class="row g-2 gy-3">
                                <div class="col-auto flex-1">
                                    <div class="search-box">
                                        <form class="position-relative" data-bs-display="static"
                                              data-bs-toggle="search">
                                            <input aria-label="Search"
                                                   class="form-control search-input search"
                                                   placeholder="Search" type="search"/>
                                            <span class="fas fa-search search-box-icon"></span>

                                        </form>
                                    </div>
                                </div>
                                <div class="col-auto">
                                    <a class="btn btn-sm btn-phoenix-secondary bg-white hover-bg-100 me-2"
                                       href="{% url 'all_store_orders' %}"
                                       type="button">View All Sales
                                    </a>

                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="table-responsive mx-n1 px-1 scrollbar">
                        <table class="table table-sm fs--1 mb-0" id="myTable">
                            <thead>
                            <tr>
                                <th class="sort white-space-nowrap align-middle pe-3" data-sort="SlNo" scope="col"
                                    style="width:5%;">SL NO
                                </th>
                                <th class="sort white-space-nowrap align-middle pe-3" data-sort="orderId" scope="col"
                                    style="width:5%;">ORDER ID
                                </th>
                                <th class="sort align-middle text-end" data-sort="total" scope="col"
                                    style="width:6%; min-width: 100px;">TOTAL
                                </th>
                                <th class="sort align-middle ps-8" data-sort="customer" scope="col"
                                    style="width:28%; min-width: 250px;">CUSTOMER
                                </th>
                                <th class="sort align-middle pe-3" data-sort="paymentStatus" scope="col"
                                    style="width:10%;">PAYMENT STATUS
                                </th>
                                <th class="sort align-middle text-start pe-3" data-sort="orderStatus"
                                    scope="col" style="width:12%; min-width: 200px;">ORDER
                                    STATUS
                                </th>
                                <th class="sort align-middle text-start" data-sort="createdBy" scope="col"
                                    style="width:30%;">CREATED BY
                                </th>
                                <th class="sort align-middle text-start" data-sort="createdOn" scope="col"
                                    style="width:30%;">CREATED ON
                                </th>
                                <th class="sort align-middle text-start" data-sort="updatedBy" scope="col"
                                    style="width:30%;">UPDATED BY
                                </th>
                                <th class="sort align-middle text-start" data-sort="updatedOn" scope="col"
                                    style="width:30%;">UPDATED ON
                                </th>

                            </tr>
                            </thead>
                            <tbody class="list" id="order-table-body">
                            {% for order in orders_list %}
                            <tr class="hover-actions-trigger btn-reveal-trigger position-static">

                                <td class="align-middle white-space-nowrap py-0 SlNo"></td>

                                <td class="orderId align-middle white-space-nowrap py-0"><a class="fw-semi-bold"
                                                                                            href="{% url 'order_details_store' order.so_order_id %}">{{order.so_order_id}}</a>
                                </td>
                                <td class="orderStatus align-middle white-space-nowrap text-start fw-bold text-700 text-end">
                                    â‚¹{{order.total_cost}}
                                </td>
                                <td class="customer align-middle white-space-nowrap ps-8">
                                    <a class="d-flex align-items-center" href="{% url 'view_store_customer_details' order.so_customer_id %}">
                                        <div class="avatar avatar-m">
                                            <div class="avatar-name rounded-circle">
                                                <span>{{order.customer_name.0}}</span></div>
                                        </div>
                                        <h6 class="mb-0 ms-3 text-900">{{order.customer_name}}</h6>
                                    </a>
                                </td>
                                <td class="paymentStatus align-middle white-space-nowrap text-start fw-bold text-700">
                                    {% if order.so_payment_status == 1 %}
                                    <span class="badge badge-phoenix fs--2 badge-phoenix-secondary"><span
                                            class="badge-label">PENDING</span><span class="ms-1"
                                                                                    data-feather="check"
                                                                                    style="height:12.8px;width:12.8px;"></span></span>
                                    {% elif order.so_payment_status == 2 %}
                                    <span class="badge badge-phoenix fs--2 badge-phoenix-success"><span
                                            class="badge-label">COMPLETE</span><span class="ms-1"
                                                                                     data-feather="check"
                                                                                     style="height:12.8px;width:12.8px;"></span></span>
                                    {% elif order.so_payment_status == 3 %}
                                    <span class="badge badge-phoenix fs--2 badge-phoenix-danger"><span
                                            class="badge-label">REFUNDED</span><span class="ms-1"
                                                                                     data-feather="check"
                                                                                     style="height:12.8px;width:12.8px;"></span></span>
                                    {% endif %}
                                </td>
                                <td class="orderStatus align-middle white-space-nowrap text-start fw-bold text-700">
                                    {% if order.so_order_status == 1 %}
                                    <span class="badge badge-phoenix fs--2 badge-phoenix-secondary"><span
                                            class="badge-label">NEW</span><span class="ms-1" data-feather="check"
                                                                                style="height:12.8px;width:12.8px;"></span></span>
                                    {% elif order.so_order_status == 2 %}
                                    <span class="badge badge-phoenix fs--2 badge-phoenix-secondary"><span
                                            class="badge-label">PROCESSING</span><span class="ms-1" data-feather="check"
                                                                                       style="height:12.8px;width:12.8px;"></span></span>
                                    {% elif order.so_order_status == 3 %}
                                    <span class="badge badge-phoenix fs--2 badge-phoenix-secondary"><span
                                            class="badge-label">READY</span><span class="ms-1" data-feather="check"
                                                                                  style="height:12.8px;width:12.8px;"></span></span>
                                    {% elif order.so_order_status == 4 %}
                                    <span class="badge badge-phoenix fs--2 badge-phoenix-secondary"><span
                                            class="badge-label">DISPATCHED</span><span class="ms-1" data-feather="check"
                                                                                       style="height:12.8px;width:12.8px;"></span></span>
                                    {% elif order.so_order_status == 5 %}
                                    <span class="badge badge-phoenix fs--2 badge-phoenix-success"><span
                                            class="badge-label">READY IN STORE</span><span class="ms-1"
                                                                                            data-feather="check"
                                                                                            style="height:12.8px;width:12.8px;"></span></span>
                                    {% elif order.so_order_status == 6 %}
                                    <span class="badge badge-phoenix fs--2 badge-phoenix-success"><span
                                            class="badge-label">DELIVERED CUSTOMER</span><span class="ms-1"
                                                                                               data-feather="check"
                                                                                               style="height:12.8px;width:12.8px;"></span></span>
                                    {% elif order.so_order_status == 7 %}
                                    <span class="badge badge-phoenix fs--2 badge-phoenix-danger"><span
                                            class="badge-label">CANCELLED</span><span class="ms-1" data-feather="check"
                                                                                      style="height:12.8px;width:12.8px;"></span></span>
                                    {% endif %}

                                </td>
                                <td class="createdBy align-middle white-space-nowrap text-900 fs--1 text-start">
                                    <a href="{% url 'view_employee' order.so_created_by %}">{{order.creator_name}}</a>
                                </td>
                                <td class="createdOn align-middle white-space-nowrap text-700 fs--1 ps-4 text-end">
                                    {{order.so_created_on}}
                                </td>
                                <td class="updatedBy align-middle white-space-nowrap text-900 fs--1 text-start">
                                    <a href="{% url 'view_employee' order.so_updated_by %}">{{order.updater_name}}</a>

                                </td>
                                <td class="updatedOn align-middle white-space-nowrap text-700 fs--1 ps-4 text-end">
                                    {{order.so_updated_on}}
                                </td>
                            </tr>
                            {% endfor %}

                            </tbody>
                        </table>

                    </div>
                    <div class="row align-items-center py-1">
                        <div class="pagination d-none"></div>
                        <div class="col d-flex fs--1">
                            <p class="mb-0 d-none d-sm-block me-3 fw-semi-bold text-900"
                               data-list-info="data-list-info"></p><a class="fw-semi-bold" data-list-view="*" href="#!">View
                            all<span class="fas fa-angle-right ms-1" data-fa-transform="down-1"></span></a><a
                                class="fw-semi-bold d-none" data-list-view="less" href="#!">View Less</a>
                        </div>
                        <div class="col-auto d-flex">

                            <button class="btn btn-link px-1 me-1" data-list-pagination="prev" title="Previous"
                                    type="button"><span class="fas fa-chevron-left me-2"></span>Previous
                            </button>
                            <button class="btn btn-link px-1 ms-1" data-list-pagination="next" title="Next"
                                    type="button">Next<span class="fas fa-chevron-right ms-2"></span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            {% include 'footer.html' %}
        </div>
    </div>
</main>
<!-- ===============================================-->
<!--    End of Main Content-->
<!-- ===============================================-->


<!-- ===============================================-->
<!--    JavaScripts-->
<!-- ===============================================-->
<script src="{% static 'vendors/popper/popper.min.js' %}"></script>
<script src="{% static 'vendors/bootstrap/bootstrap.min.js' %}"></script>
<script src="{% static 'vendors/anchorjs/anchor.min.js' %}"></script>
<script src="{% static 'vendors/is/is.min.js' %}"></script>
<script src="{% static 'vendors/fontawesome/all.min.js' %}"></script>
<script src="{% static 'vendors/lodash/lodash.min.js' %}"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=window.scroll"></script>
<script src="{% static 'vendors/list.js/list.min.js' %}"></script>
<script src="{% static 'vendors/feather-icons/feather.min.js' %}"></script>
<script src="{% static 'vendors/dayjs/dayjs.min.js' %}"></script>
<script src="{% static 'js/phoenix.js' %}"></script>
<script src="{% static 'vendors/echarts/echarts.min.js' %}"></script>
<script src="{% static 'vendors/chart/chart.min.js' %}"></script>
<script>
       const { getColor, getData, getPastDates, resize } = window.phoenix.utils;

</script>
<script>


document.addEventListener("DOMContentLoaded", function () {
    var today = new Date();
    var thirtyDaysAgo = new Date();
    thirtyDaysAgo.setDate(today.getDate() - 30);

    var todayFormatted = today.toLocaleDateString('en-GB');
    var thirtyDaysAgoFormatted = thirtyDaysAgo.toLocaleDateString('en-GB');

    flatpickr("#timepicker2", {
        mode: "range",
        dateFormat: "d/m/Y",
        disableMobile: true,
        maxDate: "today",
        defaultDate: [thirtyDaysAgoFormatted, todayFormatted]
    });
    var formattedToday = `${(today.getMonth() + 1).toString().padStart(2, '0')}/${today.getDate().toString().padStart(2, '0')}/${today.getFullYear()}`;
    var formattedToDate = `${(thirtyDaysAgo.getMonth() + 1).toString().padStart(2, '0')}/${thirtyDaysAgo.getDate().toString().padStart(2, '0')}/${thirtyDaysAgo.getFullYear()}`;
    const apiEndpoint = '{% url 'get_store_sale_analytics' %}';
    const requestBody = {
        toDate: formattedToday,
        fromDate: formattedToDate,
        intervalInDays: 30,
        storeType:1,
        storeId:{{request.session.assigned_store_id}}
    };

    fetch(apiEndpoint, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            // Add any additional headers if needed
        },
        body: JSON.stringify(requestBody)
    })
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }
            return response.json(); // Assuming the response is in JSON format
        })
        .then(data => {
            setUpChart(formattedToday, formattedToDate, 30, data.store_sale_stats, data.franchiseStoreSales);
            console.log('API Response:', data);
            // You can use the data here as needed
        })
        .catch(error => {
            console.error('Error fetching data:', error);
        });

});


function setUpChart(fromDate, toDate, interval, ownStoreData, franchiseStoreData) {
    const { getColor, getData, getDates, getItemFromStore, resize } = window.phoenix.utils;
    const $totalSalesChart = document.querySelector('.echart-total-sales-chart');

    const dates = getDates(
        new Date(toDate),
        new Date(fromDate),
        1000 * 60 * 60 * 24
    );

    const tooltipFormatter = params => {
        const currentDate = window.dayjs(params[0].axisValue);
        const prevDate = window.dayjs(params[0].axisValue).subtract(1, 'month');

        const result = params.map((param, index) => ({
            value: param.value,
            date: index > 0 ? 'FRANCHISE STORES' : 'OWN STORES',
            color: param.color,
            currentDate: currentDate
        }));

        let tooltipItem = ``;
        result.forEach((el, index) => {
            tooltipItem += `<div class='ms-1'>
        <h6 class="text-700">${el.currentDate.format('DD MMM')}</h6>
    </div><h6 class="fs--1 text-700 ${index > 0 && 'mb-0'
                }"><span class="fas fa-circle me-2" style="color:${el.color}"></span>
      ${el.date} : ${el.value}
    </h6>`;
        });
        return `<div class='ms-1'>
              ${tooltipItem}
            </div>`;
    };

    if ($totalSalesChart) {
        const userOptions = getData($totalSalesChart, 'echarts');
        const chart = window.echarts.init($totalSalesChart);

        const getDefaultOptions = () => ({
            color: [getColor('primary'), getColor('info')],
            tooltip: {
                trigger: 'axis',
                padding: 10,
                backgroundColor: getColor('gray-100'),
                borderColor: getColor('gray-300'),
                textStyle: { color: getColor('dark') },
                borderWidth: 1,
                transitionDuration: 0,
                axisPointer: {
                    type: 'none'
                },
                formatter: tooltipFormatter
            },
            xAxis: [
                {
                    type: 'category',
                    data: dates,
                    axisLabel: {
                        formatter: value => window.dayjs(value).format('DD MMM'),
                        interval: 13,
                        showMinLabel: true,
                        showMaxLabel: false,
                        color: getColor('gray-800'),
                        align: 'left',
                        fontFamily: 'Nunito Sans',
                        fontWeight: 600,
                        fontSize: 12.8
                    },
                    axisLine: {
                        show: true,
                        lineStyle: {
                            color: getColor('gray-200')
                        }
                    },
                    axisTick: {
                        show: false
                    },
                    splitLine: {
                        show: true,
                        interval: 0,
                        lineStyle: {
                            color:
                                getItemFromStore('phoenixTheme') === 'dark'
                                    ? getColor('gray-100')
                                    : getColor('gray-200')
                        }
                    },
                    boundaryGap: false
                },
                {
                    type: 'category',
                    position: 'bottom',
                    data: dates,
                    axisLabel: {
                        formatter: value => window.dayjs(value).format('DD MMM'),
                        interval: 130,
                        showMaxLabel: true,
                        showMinLabel: false,
                        color: getColor('gray-800'),
                        align: 'right',
                        fontFamily: 'Nunito Sans',
                        fontWeight: 600,
                        fontSize: 12.8
                    },
                    axisLine: {
                        show: false
                    },
                    axisTick: {
                        show: false
                    },
                    splitLine: {
                        show: false
                    },
                    boundaryGap: false
                }
            ],
            yAxis: {
                position: 'right',
                axisPointer: { type: 'none' },
                axisTick: 'none',
                splitLine: {
                    show: false
                },
                axisLine: { show: false },
                axisLabel: { show: false }
            },
            series: [
                {
                    name: 'd',
                    type: 'line',
                    // data: Array.from(Array(30).keys()).map(() =>
                    //   getRandomNumber(100, 300)
                    // ),
                    data: ownStoreData,
                    showSymbol: false,
                    symbol: 'circle'
                },
                {
                    name: 'e',
                    type: 'line',
                    // data: Array.from(Array(30).keys()).map(() =>
                    //   getRandomNumber(100, 300)
                    // ),
                    data: franchiseStoreData,
                    // symbol: 'none',
                    lineStyle: {
                        type: 'dashed',
                        width: 1,
                        color: getColor('info')
                    },
                    showSymbol: false,
                    symbol: 'circle'
                }
            ],
            grid: {
                right: 2,
                left: 5,
                bottom: '20px',
                top: '2%',
                containLabel: false
            },
            animation: false
        });

        echartSetOption(chart, userOptions, getDefaultOptions);

        resize(() => {
            chart.resize();
        });
    }
}
const { merge } = window._;

const echartSetOption = (chart, userOptions, getDefaultOptions) => {
    const themeController = document.body;
    chart.setOption(merge(getDefaultOptions(), userOptions));
    themeController.addEventListener(
        'clickControl',
        ({ detail: { control } }) => {
            if (control === 'phoenixTheme') {
                chart.setOption(window._.merge(getDefaultOptions(), userOptions));
            }
        }
    );
};


function callApiForSalesGraph(value) {

    const dateParts = value.split(" to ");
    const fromDate = formatDate(dateParts[0]);
    const toDate = formatDate(dateParts[1]);
    const intervalInMilliseconds = new Date(toDate) - new Date(fromDate);
    const intervalInDays = Math.floor(intervalInMilliseconds / (1000 * 60 * 60 * 24));
    console.log(intervalInDays);
    const apiEndpoint = '{% url 'get_store_sale_analytics' %}';
    const requestBody = {
        toDate: toDate,
        fromDate: fromDate,
        intervalInDays: intervalInDays,
        storeType:1,
        storeId:{{request.session.assigned_store_id}}
    };

    fetch(apiEndpoint, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            // Add any additional headers if needed
        },
        body: JSON.stringify(requestBody)
    })
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }
            return response.json(); // Assuming the response is in JSON format
        })
        .then(data => {
            setUpChart(toDate, fromDate, intervalInDays, data.store_sale_stats, data.franchiseStoreSales);
            console.log('API Response:', data);
            // You can use the data here as needed
        })
        .catch(error => {
            console.error('Error fetching data:', error);
        });

}

function formatDate(inputDate) {
    const [day, month, year] = inputDate.split("/");
    const formattedDate = `${month.padStart(2, '0')}/${day.padStart(2, '0')}/${year}`;
    return formattedDate;
}




var customersViewRadioButtons = document.querySelectorAll('input[name="customersView"]');

document.addEventListener('DOMContentLoaded', function () {
    var radioButtons = document.querySelectorAll('input[name="customersView"]');

    // Find the initially selected radio button
    var selectedRadioButton = document.querySelector('input[name="customersView"]:checked');

    // Get the value of the initially selected radio button
    var initialValue = selectedRadioButton ? selectedRadioButton.value : null;

    makeApiCallForCustomers(initialValue);
});

customersViewRadioButtons.forEach(function (radioButton) {
    radioButton.addEventListener('change', function () {
        // Check which radio button is selected
        if (this.checked) {
            console.log(this.value);
            // Trigger API call with the selected value
            makeApiCallForCustomers(this.value);
        }
    });
});

function makeApiCallForCustomers(value) {

    const requestBody = {
        type: value,
        storeType:1,
        storeId:{{request.session.assigned_store_id}}
    };
    const apiEndpoint = '{% url 'get_store_customer_analytics' %}';

    fetch(apiEndpoint, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            // Add any additional headers if needed
        },
        body: JSON.stringify(requestBody)
    })
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }
            return response.json(); // Assuming the response is in JSON format
        })
        .then(data => {
            setupCustomersChart(data.interval, data.list);
            console.log('API Response:', data);
            // You can use the data here as needed
        })
        .catch(error => {
            console.error('Error fetching data:', error);
        });

}

function setupCustomersChart(interval, data) {
    const $projectionVsActualChartEl = document.querySelector(
        '.echart-projection-actual'
    );
    const dates = getPastDates(interval);

    const data2 = data;

    const tooltipFormatter = params => {
        const currentDate = window.dayjs(params[0].axisValue);
        const prevDate = window.dayjs(params[0].axisValue).subtract(1, 'month');

        const result = params.map((param, index) => ({
            value: param.value,
            date: index > 0 ? prevDate : currentDate,
            color: param.color
        }));

        let tooltipItem = ``;
        result.forEach((el, index) => {
            tooltipItem += `<h6 class="fs--1 text-700 ${index > 0 && 'mb-0'
                }"><div class='ms-1'>
        <h6 class="text-700">${el.date.format('MMM DD')}</h6>
    </div><span class="fas fa-circle me-2" style="color:${el.color}"></span>
      Customers : ${el.value}
    </h6>`;
        });
        return `<div class='ms-1'>
              ${tooltipItem}
            </div>`;
    };
    if ($projectionVsActualChartEl) {
        const userOptions = getData($projectionVsActualChartEl, 'echarts');
        const chart = echarts.init($projectionVsActualChartEl);

        const getDefaultOptions = () => ({
            color: [getColor('primary'), getColor('gray-300')],
            tooltip: {
                trigger: 'axis',
                padding: [7, 10],
                backgroundColor: getColor('gray-100'),
                borderColor: getColor('gray-300'),
                textStyle: { color: getColor('dark') },
                borderWidth: 1,
                transitionDuration: 0,
                axisPointer: {
                    type: 'none'
                },
                formatter: params => tooltipFormatter(params)
            },
            legend: {
                data: ['Projected revenue', 'Actual revenue'],
                right: 'right',
                width: '100%',
                itemWidth: 16,
                itemHeight: 8,
                itemGap: 20,
                top: 3,
                inactiveColor: getColor('gray-500'),
                textStyle: {
                    color: getColor('gray-900'),
                    fontWeight: 600,
                    fontFamily: 'Nunito Sans'
                    // fontSize: '12.8px'
                }
            },
            xAxis: {
                type: 'category',
                // boundaryGap: false,
                axisLabel: {
                    color: getColor('gray-800'),
                    formatter: value => window.dayjs(value).format('MMM DD'),
                    fontFamily: 'Nunito Sans',
                    fontWeight: 600,
                    fontSize: 12.8
                },
                data: dates,
                axisLine: {
                    lineStyle: {
                        color: getColor('gray-300')
                    }
                },
                axisTick: false
            },
            yAxis: {
                axisPointer: { type: 'none' },
                // boundaryGap: false,
                axisTick: 'none',
                splitLine: {
                    interval: 5,
                    lineStyle: {
                        color: getColor('gray-200')
                    }
                },
                axisLine: { show: false },
                axisLabel: {
                    fontFamily: 'Nunito Sans',
                    fontWeight: 600,
                    fontSize: 12.8,
                    color: getColor('gray-800'),
                    margin: 20,
                    verticalAlign: 'bottom',
                    formatter: value => `${value.toLocaleString()}`
                }
            },
            series: [
                {
                    type: 'bar',
                    barWidth: '6px',
                    data: data2,
                    barGap: '30%',
                    label: { show: false },
                    itemStyle: {
                        borderRadius: [2, 2, 0, 0],
                        color: getColor('primary')
                    }
                },
            ],
            grid: {
                right: 0,
                left: 3,
                bottom: 0,
                top: '15%',
                containLabel: true
            },
            animation: false
        });

        echartSetOption(chart, userOptions, getDefaultOptions);

        resize(() => {
            chart.resize();
        });
    }
}



var radioButtons = document.querySelectorAll('input[name="ordersView"]');


radioButtons.forEach(function (radioButton) {
    radioButton.addEventListener('change', function () {
        // Check which radio button is selected
        if (this.checked) {
            console.log(this.value);
            // Trigger API call with the selected value
            makeApiCallForOrders(this.value);
        }
    });
});


document.addEventListener('DOMContentLoaded', function () {
    var radioButtons = document.querySelectorAll('input[name="ordersView"]');

    // Find the initially selected radio button
    var selectedRadioButton = document.querySelector('input[name="ordersView"]:checked');

    // Get the value of the initially selected radio button
    var initialValue = selectedRadioButton ? selectedRadioButton.value : null;
    makeApiCallForOrders(initialValue);
    console.log('Initial value:', initialValue);
});

function makeApiCallForOrders(value) {

    const requestBody = {
        type: value,
        storeType:1,
        storeId:{{request.session.assigned_store_id}}
    };
    const apiEndpoint = '{% url 'get_store_order_analytics' %}';

    fetch(apiEndpoint, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            // Add any additional headers if needed
        },
        body: JSON.stringify(requestBody)
    })
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }
            return response.json(); // Assuming the response is in JSON format
        })
        .then(data => {
            setupOrderAnalytics(data.interval, data.list);
            console.log('API Response:', data);
            // You can use the data here as needed
        })
        .catch(error => {
            console.error('Error fetching data:', error);
        });

}


function setupOrderAnalytics(interval, data) {

    const dates = getPastDates(interval);
    console.log(dates)


    const tooltipFormatter2 = (params, dateFormatter = 'MMM DD') => {
        const date = new Date(params[0].axisValue);
        const formattedDate = date.toLocaleDateString('en-US', { day: 'numeric', month: 'short' });

        let tooltipItem = `<div class='ms-1'>
        <h6 class="text-700">${formattedDate}</h6>
    </div>`;

        params.forEach(el => {
            tooltipItem += `<div class='ms-1'>
            <h6 class="text-700"><span class="fas fa-circle me-1 fs--2" style="color:${el.borderColor ? el.borderColor : el.color}"></span>
                ${el.seriesName} : ${typeof el.value === 'object' ? el.value[1] : el.value}
            </h6>
        </div>`;
        });

        return `<div>
        <p class='mb-2 text-600'>
        </p>
        ${tooltipItem}
    </div>`;
    };



    const { echarts: echarts$2 } = window;

    const { getColor, getData, resize } = window.phoenix.utils;

    const $returningCustomerChart = document.querySelector(
        '.echart-returning-customer'
    );

    if ($returningCustomerChart) {
        const userOptions = getData($returningCustomerChart, 'echarts');
        const chart = echarts$2.init($returningCustomerChart);
        const getDefaultOptions = () => ({
            color: getColor('gray-100'),
            legend: {
                data: [

                    {
                        name: 'Second time',
                        icon: 'roundRect',
                        itemStyle: { color: getColor('primary'), borderWidth: 0 }
                    }
                ],

                right: 'right',
                width: '100%',
                itemWidth: 16,
                itemHeight: 8,
                itemGap: 20,
                top: 3,
                inactiveColor: getColor('gray-500'),
                inactiveBorderWidth: 0,
                textStyle: {
                    color: getColor('gray-900'),
                    fontWeight: 600,
                    fontFamily: 'Nunito Sans'
                }
            },
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'none'
                },
                padding: [7, 10],
                backgroundColor: getColor('gray-100'),
                borderColor: getColor('gray-300'),
                textStyle: { color: getColor('dark') },
                borderWidth: 1,
                transitionDuration: 0,
                formatter: tooltipFormatter2
            },
            xAxis: {
                type: 'category',
                data: dates,
                show: true,
                boundaryGap: false,
                axisLine: {
                    show: true,
                    lineStyle: { color: getColor('gray-300') }
                },
                axisTick: {
                    show: false
                },
                axisLabel: {
                    // interval: 1,
                    showMinLabel: false,
                    showMaxLabel: false,
                    color: getColor('gray-800'),
                    formatter: value => {
                        const date = new Date(value);
                        const formattedDate = date.toLocaleDateString('en-US', { day: 'numeric', month: 'short' });
                        return formattedDate;
                    },
                    fontFamily: 'Nunito Sans',
                    fontWeight: 600,
                    fontSize: 12.8
                },
                splitLine: {
                    show: true,
                    lineStyle: { color: getColor('gray-200'), type: 'dashed' }
                }
            },
            yAxis: {
                type: 'value',
                boundaryGap: false,
                axisLabel: {
                    showMinLabel: true,
                    showMaxLabel: true,
                    color: getColor('gray-800'),
                    formatter: value => `${value}`,
                    fontFamily: 'Nunito Sans',
                    fontWeight: 600,
                    fontSize: 12.8
                },
                splitLine: {
                    show: true,
                    lineStyle: { color: getColor('gray-200') }
                }
            },
            series: [

                {
                    name: 'Orders',
                    type: 'line',
                    data: data,
                    showSymbol: false,
                    symbol: 'circle',
                    symbolSize: 10,
                    emphasis: {
                        lineStyle: {
                            width: 3
                        }
                    },
                    lineStyle: {
                        width: 3,
                        color: getColor('primary')
                    },
                    itemStyle: {
                        borderColor: getColor('primary'),
                        borderWidth: 3
                    }
                }
            ],
            grid: { left: 0, right: 8, top: '14%', bottom: 0, containLabel: true }
        });
        echartSetOption(chart, userOptions, getDefaultOptions);
        resize(() => {
            chart.resize();
        });
    }
}


</script>
</body>

</html>